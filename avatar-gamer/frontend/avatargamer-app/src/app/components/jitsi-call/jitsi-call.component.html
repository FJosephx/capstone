<div class="jitsi-wrapper">
  <div id="jaas-container"></div>

  <!-- BotÃ³n para mostrar/ocultar controles del robot -->
  <div class="toggle-controls-btn" *ngIf="isOperator">
    <ion-button 
      fill="solid" 
      shape="round" 
      size="small"
      [color]="showRobotControls ? 'primary' : 'medium'"
      (click)="showRobotControls = !showRobotControls">
      <ion-icon [name]="showRobotControls ? 'eye-off-outline' : 'eye-outline'" slot="icon-only"></ion-icon>
    </ion-button>
  </div>

  <div class="controls-overlay" *ngIf="isOperator && showRobotControls">
    <app-robot-controls [robotId]="robotId"></app-robot-controls>
  </div>

  <div class="bt-overlay" *ngIf="!isOperator">
    <ion-button
      expand="block"
      shape="round"
      color="primary"
      [disabled]="isConnectingBt"
      (click)="connectBluetooth()">
      <ion-spinner slot="start" *ngIf="isConnectingBt"></ion-spinner>
      <ion-icon name="bluetooth" slot="start" *ngIf="!isConnectingBt"></ion-icon>
      {{ isConnectingBt ? 'Conectando...' : 'Conectar Arduino por Bluetooth' }}
    </ion-button>
  </div>

  <div class="console-panel" *ngIf="isOperator && showConsole">
    <div class="console-header">
      <span>Consola de comandos</span>
      <ion-button size="small" fill="clear" (click)="logs = []">Limpiar</ion-button>
      <ion-button size="small" fill="clear" (click)="showConsole = false">Ocultar</ion-button>
    </div>
    <div class="console-body">
      <div *ngFor="let l of logs" class="console-line">
        <small>{{ l.timestamp }} -</small>
        <span *ngIf="l.type === 'sent'"> SENT cmd={{ l.command }} @ {{ l.url }}</span>
        <span *ngIf="l.type === 'response'"> RESP cmd={{ l.command }} => {{ l.res | json }}</span>
        <span *ngIf="l.type === 'error'"> ERROR cmd={{ l.command }} => {{ l.err | json }}</span>
      </div>
    </div>
  </div>
</div>
