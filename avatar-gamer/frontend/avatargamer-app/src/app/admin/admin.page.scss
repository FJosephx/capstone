/* ===== Layout y fondo ===== */
:host {
  --ag-card-radius: 16px;
  color: var(--ag-text);
}

ion-content {
  --background: linear-gradient(180deg, #fdfefe 0%, #f3f6fb 65%);
}
@media (prefers-color-scheme: dark) {
  ion-content {
    --background: linear-gradient(180deg, var(--ag-bg), color-mix(in oklab, var(--ag-bg), #0f172a 12%));
  }
}

/* ===== Header ===== */
ion-header ion-toolbar[color="primary"] {
  --background: var(--ag-surface);
  --color: var(--ag-text);
  --border-color: transparent;
  border-bottom: 1px solid var(--ion-border-color);
  box-shadow: 0 8px 20px rgba(15, 23, 42, .08);

  ion-title { font-weight: 800; letter-spacing: .01em; color: var(--ag-text); }
  ion-button {
    --color: var(--ag-primary);
    --background: transparent;
    --box-shadow: none;
    min-height: 44px;
  }
}

/* ===== Encabezado de página ===== */
.admin-header {
  margin-bottom: var(--ag-space-md, 1rem);

  h1 {
    margin: 0 0 .25rem;
    font-family: var(--ag-font-display, inherit);
    font-weight: 800;
    font-size: clamp(1.25rem, 1.1vw + 1rem, 1.75rem);
    color: var(--ion-text-color);
    letter-spacing: .01em;
  }

  .page-info {
    margin: 0;
    color: var(--ag-muted);
    font-size: 1rem;
  }
}

/* ===== Tarjetas base ===== */
ion-card {
  border-radius: var(--ag-card-radius);
  border: 1px solid var(--ion-border-color);
  box-shadow: var(--ag-shadow-sm);
  overflow: hidden;
  animation: ag-fade-up var(--ag-t-norm, .24s) var(--ag-ease, cubic-bezier(.2,.8,.2,1));
}
ion-card-header {
  background: color-mix(in oklab, var(--ag-surface), #dbeafe 18%);
  border-bottom: 1px solid var(--ion-border-color);

  ion-card-title { font-weight: 800; letter-spacing: .01em; }
  ion-card-subtitle { color: var(--ag-muted); margin-top: .15rem; }
}
ion-card-content { background: var(--ag-surface); }

/* ===== Cuenta ===== */
.account-card .account-id { font-weight: 800; }

/* ===== MÉTRICAS (se mantiene estructura) ===== */
.metrics-toolbar {
  display: flex;
  justify-content: flex-end;
  ion-button {
    --background: linear-gradient(135deg, var(--ag-primary), var(--ag-primary-600));
    min-height: 42px;
    border-radius: 10px;
    box-shadow: 0 8px 24px rgba(15, 23, 42, .12);
  }
}
.metrics-grid {
  .metric-block {
    border: 1px solid color-mix(in srgb, var(--ag-text), #fff 82%);
    border-radius: 18px;
    background: var(--ag-surface);
    padding: 1rem;
    box-shadow: 0 12px 32px rgba(15, 23, 42, .08);
    transition: transform var(--ag-t-fast, .15s) var(--ag-ease, ease), box-shadow var(--ag-t-fast, .15s) var(--ag-ease, ease);

    &:hover { transform: translateY(-2px); box-shadow: 0 16px 40px rgba(15, 23, 42, .12); }

    &__title {
      display: grid;
      grid-template-columns: auto 1fr;
      align-items: center;
      gap: .5rem;
      margin-bottom: .5rem;

      ion-icon { font-size: 24px; color: var(--ion-color-primary); }
      h3 { margin: 0; font-weight: 800; font-size: 1.05rem; }
    }

    ul {
      list-style: none;
      margin: 0;
      padding: 0;
      display: grid;
      gap: .375rem;

      li {
        display: flex;
        justify-content: space-between;
        align-items: baseline;
        gap: .75rem;
        padding: .35rem .5rem;
        border-radius: 10px;

        &:nth-child(odd) {
          background: color-mix(in oklab, var(--ag-surface), #dbeafe 18%);
        }
      }

      .metric-label { color: var(--ag-muted); font-size: .92rem; }
      .metric-value { font-weight: 800; font-variant-numeric: tabular-nums; }
    }
  }
}

/* ===== Gestión de usuarios ===== */
.section-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: .75rem;
  margin-bottom: .5rem;

  h2 { margin: 0; font-weight: 800; letter-spacing: .01em; }
  ion-button { --border-radius: 12px; min-height: 40px; box-shadow: var(--ag-shadow-sm); }
}

.filter-controls {
  display: grid;
  gap: .5rem;
  grid-template-columns: 1fr;
  align-items: start;

  ion-searchbar,
  ion-select,
  ion-input {
    --background: var(--ag-surface);
    --box-shadow: 0 8px 20px rgba(15, 23, 42, .05);
    border: 1px solid color-mix(in srgb, var(--ag-text), #fff 80%);
    border-radius: 12px;
    color: var(--ag-text);
  }
}
@media (min-width: 780px) {
  .filter-controls { grid-template-columns: 1.2fr .8fr .8fr auto; }
}

.ag-empty-state {
  border: 2px dashed var(--ion-border-color);
  border-radius: 16px;
  padding: 1.25rem;
  background: color-mix(in oklab, var(--ag-surface), #dbeafe 12%);
  text-align: center;

  ion-icon { font-size: 48px; color: var(--ag-muted); }
  h4 { margin: .5rem 0 .25rem; font-weight: 800; }
  p  { margin: 0; color: var(--ag-muted); }
}

.user-card {
  background: var(--ag-surface);
  border-radius: var(--ag-card-radius);
  border: 1px solid color-mix(in srgb, var(--ag-text), #fff 85%);
  box-shadow: 0 14px 36px rgba(15, 23, 42, .08);

  .user-card-header {
    display: grid;
    grid-template-columns: 1fr auto;
    gap: .5rem;
    align-items: start;
    margin-bottom: .5rem;
  }

  .user-info {
    .user-name { font-weight: 800; color: var(--ion-text-color); letter-spacing: .01em; }
    .user-id   { margin: .1rem 0 0; color: var(--ag-muted); font-size: .92rem; }
  }

  .user-actions {
    display: inline-flex; gap: .25rem;
    ion-button {
      min-height: 36px;
      border: none;
      --background: transparent;
      --background-hover: transparent;
      --color: var(--ag-muted);
      box-shadow: none;
      padding-inline: .35rem;

      &:hover { --color: var(--ag-primary); }
    }
  }

  .user-details {
    border-top: 1px dashed var(--ion-border-color);
    padding-top: .5rem;

    ion-item {
      --background: transparent;
      --padding-start: 0;
      --inner-padding-end: 0;
      --min-height: 40px;
    }

    .user-status-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-top: .25rem;
      gap: .5rem;

      ion-chip[outline] {
        --color: var(--ag-primary);
        --background: rgba(59, 130, 246, .12);
        --border-color: transparent;
        font-weight: 600;
        border-radius: 999px;
      }

      ion-badge {
        display: inline-flex;
        align-items: center;
        gap: .35rem;
        font-weight: 600;
        padding: .25rem .65rem;
        border-radius: 999px;

        ion-icon { font-size: .625rem; }
      }
    }
  }
}

/* ===== Modal FULL-SCREEN & scroll correcto ===== */
.admin-user-modal { --backdrop-opacity: .35; }
.admin-user-modal::part(content) {
  --width: 100vw; --max-width: 100vw;
  --height: 100vh; --max-height: 100vh;
  --inset: 0; --border-radius: 0; --box-shadow: none;
}

/* Scroll interno y padding para footer fijo del modal */
.admin-user-form {
  display: flex;
  flex-direction: column;
  height: 100%;
}

.admin-user-form ion-content {
  flex: 1;
  --background: var(--ag-surface);
  --padding-bottom: calc(env(safe-area-inset-bottom) + 88px);
}

.admin-user-form ion-header ion-toolbar,
.admin-user-form ion-footer ion-toolbar {
  --background: var(--ag-surface);
  --color: var(--ag-text);
  box-shadow: none;
}

.admin-user-form ion-header ion-toolbar { border-bottom: 1px solid var(--ion-border-color); border-top: none; }
.admin-user-form ion-footer ion-toolbar { border-top: 1px solid var(--ion-border-color); border-bottom: none; }

/* Inputs del modal */
.admin-user-form .form-grid ion-item {
  --background: transparent;
  border: 1px solid color-mix(in srgb, var(--ag-text), #fff 85%);
  border-radius: 12px;
  margin-bottom: .5rem;

  ion-label { font-weight: 700; }
  ion-input, ion-select { --padding-start: 12px; }
}
.admin-user-form ion-button[type="submit"] {
  --border-radius: 10px;
  min-height: 48px;
  font-weight: 600;
}

/* ===== Accesibilidad y animaciones ===== */
:focus-visible { outline: var(--ag-focus, 2px solid var(--ion-color-primary)); outline-offset: 2px; }
button, ion-button, ion-item, ion-input, ion-searchbar, ion-select { min-height: 44px; }
@keyframes ag-fade-up { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: none; } }
